# Lab 12: Kubernetes ConfigMaps


## Task 2

### Config mount

```bash
egor@egor-Swift-SF314-43:~/InnoSubjects/F23/DevOps/devops-core-course-labs/k8s$ helm install python-helm-app ./helm-python-app
NAME: python-helm-app
LAST DEPLOYED: Mon Nov 20 23:44:31 2023
NAMESPACE: default
STATUS: deployed
REVISION: 1
NOTES:
1. Get the application URL by running these commands:
  export NODE_PORT=$(kubectl get --namespace default -o jsonpath="{.spec.ports[0].nodePort}" services python-helm-app-helm-python-app)
  export NODE_IP=$(kubectl get nodes --namespace default -o jsonpath="{.items[0].status.addresses[0].address}")
  echo http://$NODE_IP:$NODE_PORT
egor@egor-Swift-SF314-43:~/InnoSubjects/F23/DevOps/devops-core-course-labs/k8s$ kubectl get pods
NAME                                               READY   STATUS    RESTARTS        AGE
python-helm-app-helm-python-app-6756b85d4b-55nng   2/2     Running   0               60s
vault-0                                            1/1     Running   1 (5d23h ago)   6d21h
vault-agent-injector-5cd8b87c6c-nbhwg              1/1     Running   1 (5d23h ago)   6d21h
egor@egor-Swift-SF314-43:~/InnoSubjects/F23/DevOps/devops-core-course-labs/k8s$ kubectl exec python-helm-app-helm-python-app-6756b85d4b-55nng -- cat /config.json
Defaulted container "helm-python-app" out of: helm-python-app, vault-agent
{"key": "secret"}
```

### ConfigMap

```bash
egor@egor-Swift-SF314-43:~/InnoSubjects/F23/DevOps/devops-core-course-labs/k8s$ kubectl get configmap
NAME               DATA   AGE
config-configmap   1      8m45s
kube-root-ca.crt   1      21d
```

### Bonus

```bash
egor@egor-Swift-SF314-43:~/InnoSubjects/F23/DevOps/devops-core-course-labs/k8s$ helm install python-helm-app ./helm-python-app
NAME: python-helm-app
LAST DEPLOYED: Tue Nov 21 00:13:13 2023
NAMESPACE: default
STATUS: deployed
REVISION: 1
NOTES:
1. Get the application URL by running these commands:
  export NODE_PORT=$(kubectl get --namespace default -o jsonpath="{.spec.ports[0].nodePort}" services python-helm-app-helm-python-app)
  export NODE_IP=$(kubectl get nodes --namespace default -o jsonpath="{.items[0].status.addresses[0].address}")
  echo http://$NODE_IP:$NODE_PORT
egor@egor-Swift-SF314-43:~/InnoSubjects/F23/DevOps/devops-core-course-labs/k8s$ kubectl get pods
NAME                                              READY   STATUS    RESTARTS        AGE
python-helm-app-helm-python-app-64cc6fb86-9phmp   2/2     Running   0               71s
vault-0                                           1/1     Running   1 (5d23h ago)   6d22h
vault-agent-injector-5cd8b87c6c-nbhwg             1/1     Running   1 (5d23h ago)   6d22h
egor@egor-Swift-SF314-43:~/InnoSubjects/F23/DevOps/devops-core-course-labs/k8s$ kubectl exec python-helm-app-helm-python-app-64cc6fb86-9phmp env | grep 'MY_SECRET'
kubectl exec [POD] [COMMAND] is DEPRECATED and will be removed in a future version. Use kubectl exec [POD] -- [COMMAND] instead.
Defaulted container "helm-python-app" out of: helm-python-app, vault-agent
MY_SECRET=DEVOPS_LAB
egor@egor-Swift-SF314-43:~/InnoSubjects/F23/DevOps/devops-core-course-labs/k8s$ kubectl get configmap
NAME               DATA   AGE
config-configmap   1      2m48s
kube-root-ca.crt   1      21d
my-env-configmap   1      2m48s
```